<% layout('./layouts/boilerplate') %>

<div class="container">
    <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-middle my-5">
        <h1>Editing Station</h1>
    </div>

    <div style="max-width: 640px; margin: 0 auto;">
        <form action="/posts/<%= post._id %>?_method=PUT" method="POST" novalidate class="validated-form pb-5" enctype="multipart/form-data">
            <div class="form-group pb-4">
                <label for="title">Title *</label>
                <input type="text" class="form-control" id="title" value="<%= post.title %>" name="post[title]" required>
                <div class="valid-feedback">Noice!</div>
            </div>

            <div class="form-group pb-4">
                <label for="text">Text</label>
                <input type="text" class="form-control" id="text" value="<%= post.text %>" name="post[text]">
                <div class="valid-feedback">Noice!</div>
            </div>

            <div class="form-group pt-3 pb-4">
                <label for="image" class="btn btn-outline-light w-100" style="cursor: pointer;" id="image-label">Replace Image</label>
                <input type="file" class="form-control" id="image" name="image" style="display: none;">
                <div class="valid-feedback">Noice!</div>
            </div>

            <div class="form-group pb-5" id="preview">
                <img src="<%= post.image.url %>" alt="" id="thumbnail" width="100%">
            </div>

            <button type="submit" class="btn btn-primary px-4 border-3 rounded-pill">Update</button>
        </form>
    </div>
</div>


<script>
    image.onchange = evt => {
        const [file] = image.files
        if (file) {
            if (document.getElementById("thumbnail")) {
                document.getElementById("thumbnail").remove();
            }
            let thumbnail = new Image();
            thumbnail.src = URL.createObjectURL(file);
            thumbnail.style.width = "100%"
            thumbnail.id = "thumbnail"
            document.getElementById('preview').appendChild(thumbnail)
        }
    }
</script>